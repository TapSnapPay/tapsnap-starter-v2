{% extends "base.html" %}
{% block content %}
<div class="grid">
  <div class="card">
    <h2 style="margin-top:0">Merchants</h2>
    <form method="post" action="/admin/merchants/new">
      <input required name="name" placeholder="Business name"/>
      <input required name="email" placeholder="Email" type="email"/>
      <button class="btn" type="submit">Create</button>
    </form>
    <table style="margin-top:14px">
      <thead><tr><th>ID</th><th>Name</th><th>Email</th><th>Created</th></tr></thead>
      <tbody>
      {% for m in merchants %}
        <tr><td>{{m.id}}</td><td>{{m.name}}</td><td>{{m.email}}</td><td class="muted">{{m.created_at}}</td></tr>
      {% else %}
        <tr><td colspan="4" class="muted">No merchants yet</td></tr>
      {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="card">
    <h2 style="margin-top:0">Recent Transactions</h2>
    <table>
      <thead><tr><th>ID</th><th>Merchant</th><th>Amount</th><th>Currency</th><th>Status</th><th>PSP Ref</th><th>Created</th></tr></thead>
      <tbody>
      {% for t in txs %}
        <tr>
          <td>{{t.id}}</td>
          <td>{{t.merchant_id}}</td>
          <td>${{ '%.2f'|format(t.amount_cents/100) }}</td>
          <td>{{t.currency}}</td>
          <td>{{t.status}}</td>
          <td class="muted">{{t.psp_reference or '-'}}</td>
          <td class="muted">{{t.created_at}}</td>
        </tr>
      {% else %}
        <tr><td colspan="7" class="muted">No transactions yet</td></tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
